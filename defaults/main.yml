---
# If users_update_strategy is set to "all" then all users will be configured
# everytime the tasks in this role are run, it it is set to "changed" than only
# user accounts that have changes will be updated. If it is set to "apache" then
# present users with users_apache_virtual_hosts defined will have their Apache
# config updated. If it is set to "phpfpm" then present users in the phpfpm group
# will have their PHP-FPM pool config file updated. If it is set to "groups" and
# the users_update_groups array is defined then only users in these groups will
# be updated. If it is set to "check" then the users: YAML is checked only.
users_update_strategy: changed
# Define users_apache to true for this role to manage the Apache VirtualHosts
users_apache: false
# Define users_chroot to true for members of the chroot group to be chrooted
users_chroot: false
# Define users_matomo to true for servers with Matomo and automatic Matomo account
# provisioning for users
users_matomo: false
# Define users_mariadb to true for this role to create MariaDB user and
# databases
users_mariadb: false
# MySQL user privileges copied from
# https://www.a2hosting.com/kb/developer-corner/mysql/mysql-user-privileges-on-shared-servers
users_mariadb_database_privileges:
  - ALTER
  - CREATE
  - CREATE ROUTINE
  - CREATE TEMPORARY TABLES
  - CREATE VIEW
  - DELETE
  - DROP
  - EXECUTE
  - INDEX
  - INSERT
  - LOCK TABLES
  - REFERENCES
  - SELECT
  - SHOW VIEW
  - TRIGGER
  - UPDATE
# Define users_phpfpm to true for this role to generate PHP FPM pools
users_phpfpm: false
# Define users_cron to true for this role to generate cron tasks
users_cron: false
# Set users_quotaon to true for this role to manage users disk quotas, this needs
# the users_basedir variable to be a partition mounted with quota options
users_quotaon: false
users_state_dir: /root/users
# Users home directories to be created as sub-directories of users_basedir
# NOTE that you can set an individual users_home to override this, for example
# for www-data set users_home: /var/www and for root set users_home: /root
users_basedir: /home
users_sites_dir: sites
users_private_dirs:
  - backups
  - bin
  - .gnupg
  - private
  - tmp
  - .ssh
users_notify_from: "Webarchitects <root@{{ inventory_hostname }}>"
users_notify_reply_to: "Webarchitects <support@webarchitects.coop>"
users_notify_headers:
  - Reply-To = {{ users_notify_reply_to }}
  - X-Auto-Response-Suppress = All
users_notify_subject_tag: webarchitects
users_notify_signature: |
  Webarch Co-operative Limited
  https://www.webarchitects.coop/
  Contact: https://webarch.net/contact
  Help:    https://docs.webarch.net/
  Status:  https://webarch.info/
users_notify_cron_append: "Reply-To: {{ users_notify_reply_to }}"
users_forward: true
users_muttrc: true
users_cert: user
#
# Define one or more of the the three following arrays if you want to overide
# the users_apache_type of php, cgi or the default of static that are set in
# the apache.conf.j2 template:
# users_apache_options:
#   - -Indexes
#   - +SymlinksIfOwnerMatch
#   - -MultiViews
#   - +IncludesNOEXEC
#   - -ExecCGI
# users_apache_index:
#   - index.php
#   - index.html
#   - index.shtml
#   - index.htm
# users_apache_override:
#   - AuthConfig
#   - FileInfo
#   - Indexes
#   - Limit
#   - Options=Indexes,SymLinksIfOwnerMatch,MultiViews,IncludesNOEXEC
#   - Nonfatal=Override
#
# https://www.php.net/manual/en/install.fpm.configuration.php
users_phpfpm_pm: dynamic
users_phpfpm_pm_max_children: 3
users_phpfpm_pm_start_servers: 2
users_phpfpm_pm_min_spare_servers: 1
users_phpfpm_pm_max_spare_servers: 1
users_phpfpm_request_terminate_timeout: 360
# These are appended, they do not overwrite previously defined php.ini values:
users_phpfpm_disable_functions:
  - chgrp
  - chmod
  - chown
  # curl_multi_exec is used by the MediaWiki VisualEditor and perhaps other things?
  # - curl_multi_exec
  - dl
  - exec
  - fsockopen
  - passthru
  - popen
  - posix_kill
  - posix_mkfifo
  - posix_setpgid
  - posix_setsid
  - posix_setuid
  # The proc_ functions are used by some features of MediaWiki
  - proc_close
  - proc_get_status
  - proc_nice
  - proc_open
  - proc_terminate
  # The shell_exec function is used by Matomo
  - shell_exec
  - show_source
  - socket_create
  - symlink
  - system
  - system_exec
  # Process Control is not compiled in by default on Debian so pcntl_
  # functions will not be available, if they need to be disabled this
  # is the list of the functions:
  # - pcntl_alarm
  # - pcntl_async_signals
  # - pcntl_errno
  # - pcntl_exec
  # - pcntl_fork
  # - pcntl_get_last_error
  # - pcntl_getpriority
  # - pcntl_setpriority
  # - pcntl_signal_dispatch
  # - pcntl_signal_get_handler
  # - pcntl_signal
  # - pcntl_sigprocmask
  # - pcntl_sigtimedwait
  # - pcntl_sigwaitinfo
  # - pcntl_strerror
  # - pcntl_wait
  # - pcntl_waitpid
  # - pcntl_wexitstatus
  # - pcntl_wifexited
  # - pcntl_wifsignaled
  # - pcntl_wifstopped
  # - pcntl_wstopsig
  # - pcntl_wtermsig
#
users_cron_daily_hour: "05"
users_cron_mysqldump_hour: "00"
# Set users_cron_tmpdir_hour to false to disable deletion of users TMPDIR
# files and directories which are older than a week for the whole server
users_cron_tmpdir_hour: "00"
# How old are TMPDIR files allowed to be before they are deleted
users_cron_tmpdir_max_age_days: 2
# Matomo user accounts will only be deleted when user accounts are deleted if
# users_matomo_delete_users is set to true
users_matomo_delete_users: false
users_ssh_authorized_keys_file_name: authorized_keys
...
